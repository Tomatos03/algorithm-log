# [2654. 使数组所有元素变成 1 的最少操作次数](https://leetcode.cn/problems/minimum-number-of-operations-to-make-all-array-elements-equal-to-1/)

## 解题思路

1. 当整个数组中的最大公因数不为$1$时, 不可能通过操作将数组全部变为$1$

2. 如果数组中存在至少一个$1$, 那么最优的操作次数是$n - one\_cnt$(数组元素个数 - 数字1在数组中的出现次数)

3. 对于数组中不存在$1$的情况, 只需要制造一个$1$, 原问题转化为通过操作得到一个$1$的最少操作次数$+ n - 1$

     

## 参考代码


```cpp
using i64 = long long;
using pii = pair<int, int>;
class Solution {
public:
    int minOperations(vector<int>& nums) {
        int n = nums.size(), mi_num = INT_MAX;
        int one_cnt = 0;
        for (int &v : nums)
            one_cnt += v == 1;

        if (one_cnt != 0)
            return n - one_cnt;

        for (int i = 0; i < n; ++i) {
            int j = i, gcd = 0, l = i;
            while (j < n && (gcd = __gcd(gcd, nums[j])) != 1)
                ++j;

            if (j == n)
                continue;

            mi_num = min(mi_num, j - i);
        }
        return mi_num == INT_MAX ? -1 : mi_num + n - 1 - one_cnt;
    }
};

```

