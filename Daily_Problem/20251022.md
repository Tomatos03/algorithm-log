# [3347. 执行操作后元素的最高频率 II](https://leetcode.cn/problems/maximum-frequency-of-an-element-after-performing-operations-ii/)

## 解题思路

1. 只需要关注$nums[i],nums[i] - k, nums[i] + k$, 因为$(nums[i] - k, nums[i] + k)$中能够得到的最优$ans$, 那么$nums[i] - k, nums[i] + k$这两个点也能够得到, 因为有操作次数限制$numOperation$, 所以还需要额外关注$nums[i]$
1. 输入数据量很大不能够直接使用$vector$来做差分数组, 转而使用有序$mp$作为差分数组, 

## 参考代码

+ 时间复杂度$O(n)$


```cpp
using i64 = long long;
using pii = pair<int, int>;
class Solution {
public:
    int maxFrequency(vector<int>& nums, int k, int numOperations) {
        int n = nums.size();
        map<int, int> mp;
        map<int, int> cnt;
        for (int &v : nums) {
            cnt[v]++;
            mp[v];
            mp[v - k]++;
            mp[v + k + 1]--;
        }

        int ans = 0, sum = 0;
        for (auto[v, w] : mp) {
            sum += w;
            ans = max(ans, min(sum - cnt[v], numOperations) + cnt[v]);
        }
        return ans;
    }
};
```
